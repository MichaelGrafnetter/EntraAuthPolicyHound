{
  "$schema": "bloodhound-opengraph.schema.json",
  "metadata": {
    "source_kind": "EntraTapPasskey"
  },
  "graph": {
    "nodes": [
      {
        "id": "AZAuthenticationPolicy@996af01c-adef-43b6-af73-7ae92866441e",
        "properties": {
          "tapIncludesAllUsers": true,
          "passkeyIncludesAllUsers": true,
          "displayname": "Entra ID Authentication Method Policy",
          "tapEnabled": true,
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "name": "AZAuthenticationPolicy@lab.dsinternals.com",
          "passkeyEnabled": true
        },
        "kinds": [
          "AZAuthenticationPolicy",
          "AZBase"
        ]
      }
    ],
    "edges": [
      {
        "kind": "AZTapExclude",
        "start": {
          "value": "83b26a09-16e4-4a48-b95d-b6b22bdef442",
          "match_by": "id",
          "kind": "AZGroup"
        },
        "end": {
          "value": "AZAuthenticationPolicy@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZAuthenticationPolicy"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Temporary Access Pass Excluded"
        }
      },
      {
        "kind": "AZMGPolicy_ReadWrite_AuthenticationMethod",
        "start": {
          "value": "73b267c7-0964-41bd-b763-a89e5ef91ec5",
          "match_by": "id",
          "kind": "AZServicePrincipal"
        },
        "end": {
          "value": "996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZTenant"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Microsoft Graph Policy.ReadWrite.AuthenticationMethod Application Permission"
        }
      },
      {
        "kind": "AZChangeAuthenticationPolicy",
        "start": {
          "value": "73b267c7-0964-41bd-b763-a89e5ef91ec5",
          "match_by": "id",
          "kind": "AZServicePrincipal"
        },
        "end": {
          "value": "AZAuthenticationPolicy@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZAuthenticationPolicy"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Can change Authentication Method Policy",
          "description": "The application is assigned the Policy.ReadWrite.AuthenticationMethod permission."
        }
      },
      {
        "kind": "AZMGUserAuthenticationMethod_ReadWrite_All",
        "start": {
          "value": "73b267c7-0964-41bd-b763-a89e5ef91ec5",
          "match_by": "id",
          "kind": "AZServicePrincipal"
        },
        "end": {
          "value": "996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZTenant"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Microsoft Graph UserAuthenticationMethod.ReadWrite.All Application Permission"
        }
      },
      {
        "kind": "AZMGUserAuthenticationMethod_Passkey_ReadWrite_All",
        "start": {
          "value": "73b267c7-0964-41bd-b763-a89e5ef91ec5",
          "match_by": "id",
          "kind": "AZServicePrincipal"
        },
        "end": {
          "value": "996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZTenant"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Microsoft Graph UserAuthenticationMethod-Passkey.ReadWrite.All Application Permission"
        }
      },
      {
        "kind": "AZChangeAuthenticationPolicy",
        "start": {
          "value": "0526716b-113d-4c15-b2c8-68e3c22b9f80@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZRole"
        },
        "end": {
          "value": "AZAuthenticationPolicy@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZAuthenticationPolicy"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Can change Authentication Method Policy",
          "description": "Members of the \"Authentication Policy Administrator\" role can manage authentication method policies, including TAP and Passkey settings."
        }
      },
      {
        "kind": "AZChangeAuthenticationPolicy",
        "start": {
          "value": "62e90394-69f5-4237-9190-012177145e10@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZRole"
        },
        "end": {
          "value": "AZAuthenticationPolicy@996af01c-adef-43b6-af73-7ae92866441e",
          "match_by": "id",
          "kind": "AZAuthenticationPolicy"
        },
        "properties": {
          "tenantid": "996af01c-adef-43b6-af73-7ae92866441e",
          "displayname": "Can change Authentication Method Policy",
          "description": "Members of the \"Global Administrator\" role can manage authentication method policies, including TAP and Passkey settings."
        }
      }
    ]
  }
}
